
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Find pairs and compute metrics between them">
      
      
      
      
        <link rel="prev" href="../matching/">
      
      
        <link rel="next" href="../map/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>compute - copairs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#copairscompute" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="copairs" class="md-header__button md-logo" aria-label="copairs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            copairs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              compute
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/cytomining/copairs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="copairs" class="md-nav__button md-logo" aria-label="copairs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    copairs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cytomining/copairs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/finding_pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Pairs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/phenotypic_activity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mAP for phenotypic activity assesement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/phenotypic_consistency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mAP for phenotypic consistency assesement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/null_size/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Determining null size for mAP p-value calculation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../matching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    matching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    compute
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    compute
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#copairs.compute" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#copairs.compute.ap_contiguous" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ap_contiguous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.average_precision" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;average_precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.batch_processing" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;batch_processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.concat_ranges" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;concat_ranges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.get_null_dists" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_null_dists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.get_similarity_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_similarity_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.null_dist_cached" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;null_dist_cached
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.p_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;p_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_abs_cosine" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_abs_cosine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_chebyshev" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_chebyshev
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_corr" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_corr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_cosine" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_cosine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_euclidean" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_euclidean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_manhattan" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_manhattan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.parallel_map" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;parallel_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.random_ap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_ap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.random_binary_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_binary_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.to_cutoffs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;to_cutoffs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../replicating/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    replicating
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#copairs.compute" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#copairs.compute.ap_contiguous" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ap_contiguous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.average_precision" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;average_precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.batch_processing" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;batch_processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.concat_ranges" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;concat_ranges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.get_null_dists" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_null_dists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.get_similarity_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_similarity_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.null_dist_cached" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;null_dist_cached
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.p_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;p_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_abs_cosine" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_abs_cosine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_chebyshev" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_chebyshev
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_corr" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_corr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_cosine" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_cosine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_euclidean" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_euclidean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.pairwise_manhattan" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pairwise_manhattan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.parallel_map" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;parallel_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.random_ap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_ap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.random_binary_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_binary_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copairs.compute.to_cutoffs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;to_cutoffs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="copairscompute">copairs.compute<a class="headerlink" href="#copairscompute" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="copairs.compute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <code>copairs.compute</code>


<a href="#copairs.compute" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Functions to compute distances and ranks using numpy operations.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="copairs.compute.ap_contiguous" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">ap_contiguous</span><span class="p">(</span><span class="n">rel_k_list</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span></code>

<a href="#copairs.compute.ap_contiguous" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute Average Precision (AP) scores from relevance labels.</p>
<p>This function calculates Average Precision (AP) scores for each profile based on
relevance labels and their associated counts. It also returns configurations
indicating the number of positive and total pairs for each profile.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rel_k_list</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of relevance labels (1 for positive pairs, 0 for negative pairs), sorted
by descending similarity within profiles.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>counts</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Array indicating how many times each profile appears in the rank list.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ap_scores</code></b> (              <code><span title="numpy.ndarray">ndarray</span></code>
)          –
          <div class="doc-md-description">
            <p>Array of Average Precision scores for each profile.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>null_confs</code></b> (              <code><span title="numpy.ndarray">ndarray</span></code>
)          –
          <div class="doc-md-description">
            <p>Array of configurations, where each row corresponds to:
- Number of positive pairs (<code>num_pos</code>).
- Total number of pairs (<code>counts</code>).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ap_contiguous</span><span class="p">(</span>
    <span class="n">rel_k_list</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">counts</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute Average Precision (AP) scores from relevance labels.</span>

<span class="sd">    This function calculates Average Precision (AP) scores for each profile based on</span>
<span class="sd">    relevance labels and their associated counts. It also returns configurations</span>
<span class="sd">    indicating the number of positive and total pairs for each profile.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rel_k_list : np.ndarray</span>
<span class="sd">        Array of relevance labels (1 for positive pairs, 0 for negative pairs), sorted</span>
<span class="sd">        by descending similarity within profiles.</span>
<span class="sd">    counts : np.ndarray</span>
<span class="sd">        Array indicating how many times each profile appears in the rank list.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ap_scores : np.ndarray</span>
<span class="sd">        Array of Average Precision scores for each profile.</span>
<span class="sd">    null_confs : np.ndarray</span>
<span class="sd">        Array of configurations, where each row corresponds to:</span>
<span class="sd">        - Number of positive pairs (`num_pos`).</span>
<span class="sd">        - Total number of pairs (`counts`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert counts into cutoff indices to segment relevance labels</span>
    <span class="n">cutoffs</span> <span class="o">=</span> <span class="n">to_cutoffs</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

    <span class="n">num_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">rel_k_list</span><span class="p">,</span> <span class="n">cutoffs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">num_pos</span><span class="p">)</span>
    <span class="n">shift</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shift</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_pos</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calculate cumulative true positives for each profile segment</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="n">rel_k_list</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">shift</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(),</span> <span class="n">counts</span><span class="p">)</span>

    <span class="c1"># Rank positions for each relevance label, adjusted by cutoff indices</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rel_k_list</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">cutoffs</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>

    <span class="c1"># Compute precision at each rank (precision = TP / rank)</span>
    <span class="n">pr_k</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="n">k</span>

    <span class="c1"># Calculate average precision scores for each profile</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
        <span class="n">ap_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduceat</span><span class="p">(</span><span class="n">pr_k</span> <span class="o">*</span> <span class="n">rel_k_list</span><span class="p">,</span> <span class="n">cutoffs</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_pos</span>

    <span class="c1"># Generate configurations (number of positive and total pairs)</span>
    <span class="n">null_confs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">num_pos</span><span class="p">,</span> <span class="n">counts</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ap_scores</span><span class="p">,</span> <span class="n">null_confs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.average_precision" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">average_precision</span><span class="p">(</span><span class="n">rel_k</span><span class="p">)</span></code>

<a href="#copairs.compute.average_precision" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute average precision based on binary list indices.</p>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">average_precision</span><span class="p">(</span><span class="n">rel_k</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute average precision based on binary list indices.&quot;&quot;&quot;</span>
    <span class="n">num_pos</span> <span class="o">=</span> <span class="n">rel_k</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pr_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rel_k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ap_values</span> <span class="o">=</span> <span class="n">pr_k</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_pos</span>
    <span class="k">return</span> <span class="n">ap_values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.batch_processing" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">batch_processing</span><span class="p">(</span><span class="n">pairwise_op</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#copairs.compute.batch_processing" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add batch processing support to pairwise operations.</p>
<p>This decorator wraps a pairwise operation to process data in batches,
enabling efficient computation and multithreading when working with large
datasets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pairwise_op</code></b>
              (<code><span title="typing.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>A function that computes pairwise operations (e.g., similarity or distance)
between two arrays of features.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>progress_bar</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether or not to show tqdm's progress bar.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Callable">Callable</span></code>
          –
          <div class="doc-md-description">
            <p>A wrapped function that processes pairwise operations in batches.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">batch_processing</span><span class="p">(</span>
    <span class="n">pairwise_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add batch processing support to pairwise operations.</span>

<span class="sd">    This decorator wraps a pairwise operation to process data in batches,</span>
<span class="sd">    enabling efficient computation and multithreading when working with large</span>
<span class="sd">    datasets.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pairwise_op : Callable</span>
<span class="sd">        A function that computes pairwise operations (e.g., similarity or distance)</span>
<span class="sd">        between two arrays of features.</span>
<span class="sd">    progress_bar : bool</span>
<span class="sd">        Whether or not to show tqdm&#39;s progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Callable</span>
<span class="sd">        A wrapped function that processes pairwise operations in batches.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">batched_fn</span><span class="p">(</span><span class="n">feats</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pair_ix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="c1"># Total number of pairs to process</span>
        <span class="n">num_pairs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair_ix</span><span class="p">)</span>

        <span class="c1"># Initialize an empty result array to store pairwise operation results</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_pairs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">par_func</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="c1"># Extract the features for the current batch of pairs</span>
            <span class="n">x_sample</span> <span class="o">=</span> <span class="n">feats</span><span class="p">[</span><span class="n">pair_ix</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="n">y_sample</span> <span class="o">=</span> <span class="n">feats</span><span class="p">[</span><span class="n">pair_ix</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

            <span class="c1"># Compute pairwise operations for the current batch</span>
            <span class="n">result</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_sample</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pairwise_op</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span>

        <span class="c1"># Use multithreading to process the batches in parallel</span>
        <span class="n">parallel_map</span><span class="p">(</span>
            <span class="n">par_func</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_pairs</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">),</span> <span class="n">progress_bar</span><span class="o">=</span><span class="n">progress_bar</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">batched_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.concat_ranges" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">concat_ranges</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></code>

<a href="#copairs.compute.concat_ranges" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a 1D array by concatenating multiple integer ranges.</p>
<p>This function generates a single concatenated array from multiple ranges defined
by the <code>start</code> and <code>end</code> arrays. Each range is inclusive of <code>start</code> and exclusive
of <code>end</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>start</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 1D array of start indices for the ranges.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>end</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 1D array of end indices for the ranges. Must have the same shape as <code>start</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array containing the concatenated ranges.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">concat_ranges</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a 1D array by concatenating multiple integer ranges.</span>

<span class="sd">    This function generates a single concatenated array from multiple ranges defined</span>
<span class="sd">    by the `start` and `end` arrays. Each range is inclusive of `start` and exclusive</span>
<span class="sd">    of `end`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start : np.ndarray</span>
<span class="sd">        A 1D array of start indices for the ranges.</span>
<span class="sd">    end : np.ndarray</span>
<span class="sd">        A 1D array of end indices for the ranges. Must have the same shape as `start`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array containing the concatenated ranges.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate individual ranges using `range` for each pair of start and end</span>
    <span class="n">slices</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

    <span class="c1"># Flatten the ranges into a single iterable</span>
    <span class="n">slices</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span>

    <span class="c1"># Calculate the total length of the concatenated ranges</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># Create a 1D array from the concatenated ranges</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">slices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mask</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.get_null_dists" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">get_null_dists</span><span class="p">(</span><span class="n">confs</span><span class="p">,</span> <span class="n">null_size</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">cache_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#copairs.compute.get_null_dists" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate null distributions for each configuration of positive and total pairs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>confs</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Array where each row contains the number of positive pairs (<code>num_pos</code>)
and total pairs (<code>total</code>) for a specific configuration.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>null_size</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of samples to generate in the null distribution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Random seed for reproducibility.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>progress_bar</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether or not to show tqdm's progress bar.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 2D array where each row corresponds to a null distribution for a specific
configuration.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_null_dists</span><span class="p">(</span>
    <span class="n">confs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">null_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">cache_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate null distributions for each configuration of positive and total pairs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    confs : np.ndarray</span>
<span class="sd">        Array where each row contains the number of positive pairs (`num_pos`)</span>
<span class="sd">        and total pairs (`total`) for a specific configuration.</span>
<span class="sd">    null_size : int</span>
<span class="sd">        Number of samples to generate in the null distribution.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed for reproducibility.</span>
<span class="sd">    progress_bar : bool</span>
<span class="sd">        Whether or not to show tqdm&#39;s progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 2D array where each row corresponds to a null distribution for a specific</span>
<span class="sd">        configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the directory for caching null distributions</span>
    <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;.copairs&quot;</span> <span class="k">if</span> <span class="n">cache_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span>
    <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">cache_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;seed</span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ns</span><span class="si">{</span><span class="n">null_size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cache_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Number of configurations and random seeds for each configuration</span>
    <span class="n">num_confs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">confs</span><span class="p">)</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">seeds</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">8096</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_confs</span><span class="p">)</span>

    <span class="c1"># Initialize an array to store null distributions</span>
    <span class="n">null_dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">confs</span><span class="p">),</span> <span class="n">null_size</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="c1"># Function to generate null distributions for each configuration</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">par_func</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">num_pos</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">confs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">null_dists</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">null_dist_cached</span><span class="p">(</span><span class="n">num_pos</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">seeds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">null_size</span><span class="p">,</span> <span class="n">cache_dir</span><span class="p">)</span>

    <span class="c1"># Parallelize the generation of null distributions</span>
    <span class="n">parallel_map</span><span class="p">(</span><span class="n">par_func</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_confs</span><span class="p">),</span> <span class="n">progress_bar</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">null_dists</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.get_similarity_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">get_similarity_fn</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#copairs.compute.get_similarity_fn" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve a similarity function based on a distance string identifier or custom callable.</p>
<p>This function provides flexibility in specifying the distance function to be used
for pairwise similarity computations. Users can choose a metrics from a predefined set,
scipy.spational.distance submodule, or provide a custom callable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>distance</code></b>
              (<code><span title="str">str</span> or <span title="callable">callable</span></code>)
          –
          <div class="doc-md-description">
            <p>The name of the distance function or a custom callable function. Supported
string identifiers for predefined metrics are:
- "cosine": Cosine similarity.
- "abs_cosine": Absolute cosine similarity.
- "correlation": Pearson correlation coefficient.
- "euclidean": Inverse Euclidean distance (scaled to range 0-1).
- "manhattan": Inverse Manhattan distance (scaled to range 0-1).
- "chebyshev": Inverse Chebyshev distance (scaled to range 0-1).</p>
<p>Additionally, any distance metric supported by <code>scipy.spatial.distance.cdist</code>
can be used by providing the metric name as a string.</p>
<p>If a callable is provided, it must accept the paramters associated with each
callable function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>progress_bar</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether or not to show tqdm's progress bar.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="callable">callable</span></code>
          –
          <div class="doc-md-description">
            <p>A function implementing the specified similarity function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>ValueError:</code>
            –
          <div class="doc-md-description">
            <p>If the provided <code>distance</code> is not a recognized string identifier or a valid callable.</p>
          </div>
        </li>
    </ul>


<details class="example:" open>
  <summary>Example:</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>distance_fn = get_distance_fn("cosine")
similarity_scores = distance_fn(x_sample, y_sample)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_similarity_fn</span><span class="p">(</span>
    <span class="n">distance</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a similarity function based on a distance string identifier or custom callable.</span>

<span class="sd">    This function provides flexibility in specifying the distance function to be used</span>
<span class="sd">    for pairwise similarity computations. Users can choose a metrics from a predefined set,</span>
<span class="sd">    scipy.spational.distance submodule, or provide a custom callable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    distance : str or callable</span>
<span class="sd">        The name of the distance function or a custom callable function. Supported</span>
<span class="sd">        string identifiers for predefined metrics are:</span>
<span class="sd">        - &quot;cosine&quot;: Cosine similarity.</span>
<span class="sd">        - &quot;abs_cosine&quot;: Absolute cosine similarity.</span>
<span class="sd">        - &quot;correlation&quot;: Pearson correlation coefficient.</span>
<span class="sd">        - &quot;euclidean&quot;: Inverse Euclidean distance (scaled to range 0-1).</span>
<span class="sd">        - &quot;manhattan&quot;: Inverse Manhattan distance (scaled to range 0-1).</span>
<span class="sd">        - &quot;chebyshev&quot;: Inverse Chebyshev distance (scaled to range 0-1).</span>

<span class="sd">        Additionally, any distance metric supported by `scipy.spatial.distance.cdist`</span>
<span class="sd">        can be used by providing the metric name as a string.</span>

<span class="sd">        If a callable is provided, it must accept the paramters associated with each</span>
<span class="sd">        callable function.</span>
<span class="sd">    progress_bar : bool</span>
<span class="sd">        Whether or not to show tqdm&#39;s progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    callable</span>
<span class="sd">        A function implementing the specified similarity function.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError:</span>
<span class="sd">        If the provided `distance` is not a recognized string identifier or a valid callable.</span>

<span class="sd">    Example:</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; distance_fn = get_distance_fn(&quot;cosine&quot;)</span>
<span class="sd">    &gt;&gt;&gt; similarity_scores = distance_fn(x_sample, y_sample)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Dictionary of supported similarity functions</span>
    <span class="n">similarity_functions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;abs_cosine&quot;</span><span class="p">:</span> <span class="n">pairwise_abs_cosine</span><span class="p">,</span>
        <span class="s2">&quot;cosine&quot;</span><span class="p">:</span> <span class="n">pairwise_cosine</span><span class="p">,</span>
        <span class="s2">&quot;correlation&quot;</span><span class="p">:</span> <span class="n">pairwise_corr</span><span class="p">,</span>
        <span class="s2">&quot;euclidean&quot;</span><span class="p">:</span> <span class="n">pairwise_euclidean</span><span class="p">,</span>
        <span class="s2">&quot;manhattan&quot;</span><span class="p">:</span> <span class="n">pairwise_manhattan</span><span class="p">,</span>
        <span class="s2">&quot;chebyshev&quot;</span><span class="p">:</span> <span class="n">pairwise_chebyshev</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># If a string is provided, look up the corresponding function</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">distance</span> <span class="ow">in</span> <span class="n">similarity_functions</span><span class="p">:</span>
            <span class="n">similarity_fn</span> <span class="o">=</span> <span class="n">similarity_functions</span><span class="p">[</span><span class="n">distance</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">distance</span> <span class="ow">in</span> <span class="n">SCIPY_METRICS_NAMES</span><span class="p">:</span>
            <span class="n">similarity_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">:</span> <span class="n">_cdist_diag_sim</span><span class="p">(</span>
                <span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">,</span> <span class="n">distance</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported distance function: </span><span class="si">{</span><span class="n">distance</span><span class="si">}</span><span class="s2">. Supported functions are: </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">similarity_functions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="n">SCIPY_METRICS_NAMES</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">distance</span><span class="p">):</span>
        <span class="c1"># If a callable is provided, use it directly</span>
        <span class="n">similarity_fn</span> <span class="o">=</span> <span class="n">distance</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Raise an error if neither a string nor a callable is provided</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Distance must be either a string or a callable object.&quot;</span><span class="p">)</span>

    <span class="c1"># Wrap the distance function for efficient batch processing</span>
    <span class="k">return</span> <span class="n">batch_processing</span><span class="p">(</span><span class="n">similarity_fn</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="n">progress_bar</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.null_dist_cached" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">null_dist_cached</span><span class="p">(</span><span class="n">num_pos</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">null_size</span><span class="p">,</span> <span class="n">cache_dir</span><span class="p">)</span></code>

<a href="#copairs.compute.null_dist_cached" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate or retrieve a cached null distribution for a given configuration.</p>
<p>This function calculates a null distribution for a specified number of positive
pairs (<code>num_pos</code>) and total pairs (<code>total</code>). It uses caching to store and
retrieve precomputed distributions, saving time and computational resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_pos</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of positive pairs in the configuration.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>total</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Total number of pairs (positive + negative) in the configuration.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Random seed for reproducibility.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>null_size</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of samples to generate in the null distribution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>cache_dir</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          –
          <div class="doc-md-description">
            <p>Directory to store or retrieve cached null distributions.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>Null distribution for the specified configuration.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">null_dist_cached</span><span class="p">(</span>
    <span class="n">num_pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">null_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cache_dir</span><span class="p">:</span> <span class="n">Path</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate or retrieve a cached null distribution for a given configuration.</span>

<span class="sd">    This function calculates a null distribution for a specified number of positive</span>
<span class="sd">    pairs (`num_pos`) and total pairs (`total`). It uses caching to store and</span>
<span class="sd">    retrieve precomputed distributions, saving time and computational resources.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num_pos : int</span>
<span class="sd">        Number of positive pairs in the configuration.</span>
<span class="sd">    total : int</span>
<span class="sd">        Total number of pairs (positive + negative) in the configuration.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed for reproducibility.</span>
<span class="sd">    null_size : int</span>
<span class="sd">        Number of samples to generate in the null distribution.</span>
<span class="sd">    cache_dir : Path</span>
<span class="sd">        Directory to store or retrieve cached null distributions.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Null distribution for the specified configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if a seed is provided to enable caching</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Define the cache file name based on the configuration</span>
        <span class="n">cache_file</span> <span class="o">=</span> <span class="n">cache_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;n</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">_k</span><span class="si">{</span><span class="n">num_pos</span><span class="si">}</span><span class="s2">.npy&quot;</span>

        <span class="c1"># If the cache file exists, try to load the null distribution from it</span>
        <span class="k">if</span> <span class="n">cache_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">null_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cache_file</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Cache file is corrupted or incomplete, remove it and regenerate</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Failed to load cache file </span><span class="si">{</span><span class="n">cache_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. Regenerating...&quot;</span>
                <span class="p">)</span>
                <span class="n">cache_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="c1"># Compute the null distribution</span>
                <span class="n">null_dist</span> <span class="o">=</span> <span class="n">random_ap</span><span class="p">(</span><span class="n">null_size</span><span class="p">,</span> <span class="n">num_pos</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

                <span class="c1"># Save the new distribution to the cache</span>
                <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="n">null_dist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the cache file doesn&#39;t exist, compute the null distribution</span>
            <span class="n">null_dist</span> <span class="o">=</span> <span class="n">random_ap</span><span class="p">(</span><span class="n">null_size</span><span class="p">,</span> <span class="n">num_pos</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

            <span class="c1"># Save the computed distribution to the cache</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="n">null_dist</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If no seed is provided, compute the null distribution without caching</span>
        <span class="n">null_dist</span> <span class="o">=</span> <span class="n">random_ap</span><span class="p">(</span><span class="n">null_size</span><span class="p">,</span> <span class="n">num_pos</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

    <span class="c1"># Return the null distribution (loaded or computed)</span>
    <span class="k">return</span> <span class="n">null_dist</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.p_values" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">p_values</span><span class="p">(</span><span class="n">ap_scores</span><span class="p">,</span> <span class="n">null_confs</span><span class="p">,</span> <span class="n">null_size</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#copairs.compute.p_values" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Calculate p-values for an array of Average Precision (AP) scores using a null distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>ap_scores</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of observed AP scores for which to calculate p-values.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>null_confs</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>Configuration array indicating the relevance or context of each AP score. Used
to generate corresponding null distributions.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>null_size</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of samples to generate in the null distribution for each configuration.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Seed for the random number generator to ensure reproducibility of the null
distribution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>progress_bar</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether or not to show tqdm's progress bar.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>An array of p-values corresponding to the input AP scores.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">p_values</span><span class="p">(</span>
    <span class="n">ap_scores</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">null_confs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">null_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate p-values for an array of Average Precision (AP) scores using a null distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ap_scores : np.ndarray</span>
<span class="sd">        Array of observed AP scores for which to calculate p-values.</span>
<span class="sd">    null_confs : np.ndarray</span>
<span class="sd">        Configuration array indicating the relevance or context of each AP score. Used</span>
<span class="sd">        to generate corresponding null distributions.</span>
<span class="sd">    null_size : int</span>
<span class="sd">        Number of samples to generate in the null distribution for each configuration.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Seed for the random number generator to ensure reproducibility of the null</span>
<span class="sd">        distribution.</span>
<span class="sd">    progress_bar : bool</span>
<span class="sd">        Whether or not to show tqdm&#39;s progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        An array of p-values corresponding to the input AP scores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Identify unique configurations and their indices</span>
    <span class="n">confs</span><span class="p">,</span> <span class="n">rev_ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">null_confs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Generate null distributions for each unique configuration</span>
    <span class="n">null_dists</span> <span class="o">=</span> <span class="n">get_null_dists</span><span class="p">(</span><span class="n">confs</span><span class="p">,</span> <span class="n">null_size</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="n">progress_bar</span><span class="p">)</span>

    <span class="c1"># Sort null distributions for efficient p-value computation</span>
    <span class="n">null_dists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Initialize an array to store the p-values</span>
    <span class="n">pvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ap_scores</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="c1"># Compute p-values for each AP score</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ap_score</span><span class="p">,</span> <span class="n">ix</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ap_scores</span><span class="p">,</span> <span class="n">rev_ix</span><span class="p">)):</span>
        <span class="c1"># Find the rank of the observed AP score in the sorted null distribution</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">null_size</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">null_dists</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">ap_score</span><span class="p">)</span>

        <span class="c1"># Calculate the p-value as the proportion of null scores &gt;= observed score</span>
        <span class="n">pvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">null_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pvals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.pairwise_abs_cosine" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">pairwise_abs_cosine</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span></code>

<a href="#copairs.compute.pairwise_abs_cosine" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the absolute cosine similarity for paired rows of two matrices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array where each row represents a profile.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array of the same shape as <code>x_sample</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>Absolute values of cosine similarity scores.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pairwise_abs_cosine</span><span class="p">(</span><span class="n">x_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the absolute cosine similarity for paired rows of two matrices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_sample : np.ndarray</span>
<span class="sd">        A 2D array where each row represents a profile.</span>
<span class="sd">    y_sample : np.ndarray</span>
<span class="sd">        A 2D array of the same shape as `x_sample`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Absolute values of cosine similarity scores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pairwise_cosine</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.pairwise_chebyshev" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">pairwise_chebyshev</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span></code>

<a href="#copairs.compute.pairwise_chebyshev" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the inverse Chebyshev distance for paired rows of two matrices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array where each row represents a profile.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array of the same shape as <code>x_sample</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array of inverse Chebyshev distance scores (scaled to range 0-1).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pairwise_chebyshev</span><span class="p">(</span><span class="n">x_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the inverse Chebyshev distance for paired rows of two matrices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_sample : np.ndarray</span>
<span class="sd">        A 2D array where each row represents a profile.</span>
<span class="sd">    y_sample : np.ndarray</span>
<span class="sd">        A 2D array of the same shape as `x_sample`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array of inverse Chebyshev distance scores (scaled to range 0-1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_sample</span> <span class="o">-</span> <span class="n">y_sample</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_dist</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.pairwise_corr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">pairwise_corr</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span></code>

<a href="#copairs.compute.pairwise_corr" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the Pearson correlation coefficient for paired rows of two matrices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array where each row represents a profile</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array of the same shape as <code>x_sample</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array of Pearson correlation coefficients for each row pair in
<code>x_sample</code> and <code>y_sample</code>.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pairwise_corr</span><span class="p">(</span><span class="n">x_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the Pearson correlation coefficient for paired rows of two matrices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_sample : np.ndarray</span>
<span class="sd">        A 2D array where each row represents a profile</span>
<span class="sd">    y_sample : np.ndarray</span>
<span class="sd">        A 2D array of the same shape as `x_sample`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array of Pearson correlation coefficients for each row pair in</span>
<span class="sd">        `x_sample` and `y_sample`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute the mean for each row</span>
    <span class="n">x_mean</span> <span class="o">=</span> <span class="n">x_sample</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">y_mean</span> <span class="o">=</span> <span class="n">y_sample</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Center the rows by subtracting the mean</span>
    <span class="n">x_center</span> <span class="o">=</span> <span class="n">x_sample</span> <span class="o">-</span> <span class="n">x_mean</span>
    <span class="n">y_center</span> <span class="o">=</span> <span class="n">y_sample</span> <span class="o">-</span> <span class="n">y_mean</span>

    <span class="c1"># Compute the numerator (dot product of centered vectors)</span>
    <span class="n">numer</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_center</span> <span class="o">*</span> <span class="n">y_center</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Compute the denominator (product of vector magnitudes)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_center</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_center</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>

    <span class="c1"># Calculate correlation coefficients</span>
    <span class="n">corrs</span> <span class="o">=</span> <span class="n">numer</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="k">return</span> <span class="n">corrs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.pairwise_cosine" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">pairwise_cosine</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span></code>

<a href="#copairs.compute.pairwise_cosine" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute cosine similarity for paired rows of two matrices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array where each row represents a profile.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array of the same shape as <code>x_sample</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array of cosine similarity scores for each row pair in <code>x_sample</code> and <code>y_sample</code>.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pairwise_cosine</span><span class="p">(</span><span class="n">x_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute cosine similarity for paired rows of two matrices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_sample : np.ndarray</span>
<span class="sd">        A 2D array where each row represents a profile.</span>
<span class="sd">    y_sample : np.ndarray</span>
<span class="sd">        A 2D array of the same shape as `x_sample`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array of cosine similarity scores for each row pair in `x_sample` and `y_sample`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Normalize each row to unit vectors</span>
    <span class="n">x_norm</span> <span class="o">=</span> <span class="n">x_sample</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">y_norm</span> <span class="o">=</span> <span class="n">y_sample</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y_sample</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

    <span class="c1"># Compute the dot product of normalized vectors</span>
    <span class="n">c_sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x_norm</span> <span class="o">*</span> <span class="n">y_norm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c_sim</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.pairwise_euclidean" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">pairwise_euclidean</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span></code>

<a href="#copairs.compute.pairwise_euclidean" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the inverse Euclidean distance for paired rows of two matrices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array where each row represents a profile.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array of the same shape as <code>x_sample</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array of inverse Euclidean distance scores (scaled to range 0-1).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pairwise_euclidean</span><span class="p">(</span><span class="n">x_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the inverse Euclidean distance for paired rows of two matrices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_sample : np.ndarray</span>
<span class="sd">        A 2D array where each row represents a profile.</span>
<span class="sd">    y_sample : np.ndarray</span>
<span class="sd">        A 2D array of the same shape as `x_sample`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array of inverse Euclidean distance scores (scaled to range 0-1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute Euclidean distance and scale to a range of 0 to 1</span>
    <span class="n">e_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">x_sample</span> <span class="o">-</span> <span class="n">y_sample</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e_dist</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.pairwise_manhattan" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">pairwise_manhattan</span><span class="p">(</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span></code>

<a href="#copairs.compute.pairwise_manhattan" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the inverse Manhattan distance for paired rows of two matrices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array where each row represents a profile.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y_sample</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 2D array of the same shape as <code>x_sample</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array of inverse Manhattan distance scores (scaled to range 0-1).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pairwise_manhattan</span><span class="p">(</span><span class="n">x_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the inverse Manhattan distance for paired rows of two matrices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_sample : np.ndarray</span>
<span class="sd">        A 2D array where each row represents a profile.</span>
<span class="sd">    y_sample : np.ndarray</span>
<span class="sd">        A 2D array of the same shape as `x_sample`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array of inverse Manhattan distance scores (scaled to range 0-1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_sample</span> <span class="o">-</span> <span class="n">y_sample</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">m_dist</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.parallel_map" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">parallel_map</span><span class="p">(</span><span class="n">par_func</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#copairs.compute.parallel_map" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Execute a function in parallel over a list of items.</p>
<p>This function uses a thread pool to process items in parallel, with progress
tracking via <code>tqdm</code>. It is particularly useful for batch operations that benefit
from multithreading.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>par_func</code></b>
              (<code><span title="typing.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>A function to execute for each item. It should accept a single argument
(an item index or value).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>items</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>An array or list of items to process.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parallel_map</span><span class="p">(</span>
    <span class="n">par_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
    <span class="n">items</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute a function in parallel over a list of items.</span>

<span class="sd">    This function uses a thread pool to process items in parallel, with progress</span>
<span class="sd">    tracking via `tqdm`. It is particularly useful for batch operations that benefit</span>
<span class="sd">    from multithreading.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    par_func : Callable</span>
<span class="sd">        A function to execute for each item. It should accept a single argument</span>
<span class="sd">        (an item index or value).</span>
<span class="sd">    items : np.ndarray</span>
<span class="sd">        An array or list of items to process.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Total number of items to process</span>
    <span class="n">num_items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

    <span class="c1"># Determine the number of threads to use, limited by CPU count</span>
    <span class="n">pool_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_items</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>

    <span class="c1"># Calculate chunk size for dividing work among threads</span>
    <span class="n">chunksize</span> <span class="o">=</span> <span class="n">num_items</span> <span class="o">//</span> <span class="n">pool_size</span>

    <span class="c1"># Use a thread pool to execute the function in parallel</span>
    <span class="k">with</span> <span class="n">ThreadPool</span><span class="p">(</span><span class="n">pool_size</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
        <span class="c1"># Map the function to items with unordered execution for better efficiency</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">imap_unordered</span><span class="p">(</span><span class="n">par_func</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">progress_bar</span><span class="p">:</span>
            <span class="c1"># Display progress using tqdm</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.autonotebook</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

            <span class="n">tasks</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">tasks</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.random_ap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">random_ap</span><span class="p">(</span><span class="n">num_perm</span><span class="p">,</span> <span class="n">num_pos</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span></code>

<a href="#copairs.compute.random_ap" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate random Average Precision (AP) scores to create a null distribution.</p>
<p>This function computes multiple Average Precision (AP) scores based on randomly
generated binary relevance lists. It is useful for generating a null distribution
to assess the significance of observed AP scores.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>num_perm</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of random permutations (i.e., how many random relevance lists to generate).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>num_pos</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of positive samples (1's) in each relevance list.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>total</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Total number of samples (columns) in each relevance list.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Seed for the random number generator to ensure reproducibility.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array containing the Average Precision scores for each randomly
generated relevance list.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_ap</span><span class="p">(</span><span class="n">num_perm</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate random Average Precision (AP) scores to create a null distribution.</span>

<span class="sd">    This function computes multiple Average Precision (AP) scores based on randomly</span>
<span class="sd">    generated binary relevance lists. It is useful for generating a null distribution</span>
<span class="sd">    to assess the significance of observed AP scores.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num_perm : int</span>
<span class="sd">        Number of random permutations (i.e., how many random relevance lists to generate).</span>
<span class="sd">    num_pos : int</span>
<span class="sd">        Number of positive samples (1&#39;s) in each relevance list.</span>
<span class="sd">    total : int</span>
<span class="sd">        Total number of samples (columns) in each relevance list.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Seed for the random number generator to ensure reproducibility.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array containing the Average Precision scores for each randomly</span>
<span class="sd">        generated relevance list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize the random number generator</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="c1"># Generate a binary matrix with `num_perm` rows and `total` columns,</span>
    <span class="c1"># where each row contains exactly `num_pos` ones distributed randomly</span>
    <span class="n">rel_k</span> <span class="o">=</span> <span class="n">random_binary_matrix</span><span class="p">(</span><span class="n">num_perm</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">num_pos</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>

    <span class="c1"># Compute Average Precision (AP) scores for each row of the binary matrix</span>
    <span class="n">null_dist</span> <span class="o">=</span> <span class="n">average_precision</span><span class="p">(</span><span class="n">rel_k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">null_dist</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.random_binary_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">random_binary_matrix</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span></code>

<a href="#copairs.compute.random_binary_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a indices of k values in 1 per row in a random binary n*m matrix.</p>
<p>Args:
n: Number of rows.
m: Number of columns.
k: Number of 1's per row.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A binary matrix of shape <code>(n, m)</code> with exactly <code>k</code> ones per row.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_binary_matrix</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">rng</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a indices of k values in 1 per row in a random binary n*m matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">    n: Number of rows.</span>
<span class="sd">    m: Number of columns.</span>
<span class="sd">    k: Number of 1&#39;s per row.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A binary matrix of shape `(n, m)` with exactly `k` ones per row.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span> <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">),</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">rng</span><span class="o">.</span><span class="n">permuted</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">indices</span><span class="p">[:,</span> <span class="p">:</span><span class="n">k</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="copairs.compute.to_cutoffs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">to_cutoffs</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span></code>

<a href="#copairs.compute.to_cutoffs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert counts into cumulative cutoff indices.</p>
<p>This function generates a 1D array of indices that mark the start of each segment
in a cumulative list. The first index is always <code>0</code>, and subsequent indices
correspond to the cumulative sum of counts up to the previous entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>counts</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>A 1D array of counts representing the size of each segment.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>A 1D array of cutoff indices where each value indicates the starting index
for the corresponding segment.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/copairs/compute.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_cutoffs</span><span class="p">(</span><span class="n">counts</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert counts into cumulative cutoff indices.</span>

<span class="sd">    This function generates a 1D array of indices that mark the start of each segment</span>
<span class="sd">    in a cumulative list. The first index is always `0`, and subsequent indices</span>
<span class="sd">    correspond to the cumulative sum of counts up to the previous entry.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    counts : np.ndarray</span>
<span class="sd">        A 1D array of counts representing the size of each segment.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A 1D array of cutoff indices where each value indicates the starting index</span>
<span class="sd">        for the corresponding segment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize an empty array for cutoff indices</span>
    <span class="n">cutoffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

    <span class="c1"># Set the first cutoff to 0 (start of the first segment)</span>
    <span class="n">cutoffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Compute subsequent cutoffs using cumulative sums, excluding the last element</span>
    <span class="n">cutoffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">cutoffs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>